\chapter{Taylor and Maclaurin Series}

Consider the generic power series:
$$f(x) = c_0 + c_1(x - a) + c_2(x - a)^2 + c_3(x - a)^3 + \cdots + c_n(x - a)^n$$
Notice that substituting $x = a$ yields:
$$f(a) = c_0$$
Suppose we differentiate both sides, which gives:
$$f'(x) = c_1 + 2c_2(x - a) + 3c_3(x - a)^2 + \cdots nc_n(x-a)^{n-1}$$
Again, substituting $x = a$:
$$f'(a) = c_1$$
Continuing, we see that
$$f''(x) = 2c_2 + 2 \cdot 3c_3(x-a) + \cdot + sn(n-1)(x-a)^{n-2}$$
And
$$f''(a) = 2c_2$$
Once more, we see that:
$$f'''(x) = 2 \cdot 3 c_3 + 2 \cdot 3 c\dot 4 (x-a) + \cdots + n (n-1)(n-2)(x-a)^{n-3}$$
And substituting $x = a$ gives
$$f'''(a) = 2 \cdot 3 c_3 = 3!c_3$$

Do you see the pattern? It is 
$$f^{(n)}(a) = 2 \cdot 3 \cdot 4 \cdot \cdots \cdot nc_n = n!c_n$$
Which also means that 
$$c_n = \frac{f^{(n)}(a)}{n!}$$
(recall the convention that $0! = 1$, so this is valid for $n = 0$ as well). 

If we substitute for $c_n$ into our definition of a power series, we get a 
\textbf{Taylor series}\index{Taylor series}:
$$f(x) = \sum_{n=0}^\infty \frac{f^{(n)}(a)}{n!} \left( x - a \right)^n$$

This is called the \textit{Taylor series of $f$ centered at $a$}. If $a = 0$, 
we call this special case a \textbf{Maclaurin series}\index{Maclaurin series}:
$$f(x) = \sum_{n=0}^\infty \frac{f^{(n)}(0)}{n!}x^n$$

\textbf{Example}: Find the Maclaurin series for $f(x) = e^x$ and its radius of 
convergence.

\textbf{Solution}: We know that if $f(x) = e^x$, then $f'(x) = e^x$, and 
$f''(x) = e^x$, $\cdots$, $f^{(n)}(x) = e^x$. Since $e^0 = 1$, we can say that 
$f^{(n)}(0) = 1$ for all $n$. Substituting this into our equation for 
Maclaurin series:
$$f(x) = \sum_{n=0}^\infty \frac{f^{(n)}(0)}{n!}x^n = \sum_{n=0}^\infty 
\frac{1}{n!}x^n $$
$$= \sum_{n=0}^\infty \frac{x^n}{n!}$$

Taking $a_n = \frac{x^n}{n!}$ and applying the Ratio test, we can find the 
radius of convergence:
$$\lim_{n \to \infty} \left| \frac{a_{n + 1}}{a_n} \right| < 1$$
$$\lim_{n \to \infty} \left| \frac{x^{n + 1}}{(n+1)n!} \cdot \frac{n!}{x^n} 
\right| < 1$$
$$\lim_{n \to \infty} \frac{|x|}{n + 1} = 0 < 1$$
The limit converges to 0 for all $x$, so the radius of convergence is $\infty$.

We can confirm this graphically. But first, a quick definition. The $n^{th}$-
degree Taylor polynomial is the first $n$ terms of the infinite Taylor 
polynomial. That is,
$$T_n(x) = \sum_{i=0}^n \frac{f^{(n)}(a)}{i!}(x - a)^n$$

In the case of $f(x) = e^x$ and $a = 0$, the $n^{th}$ degree Taylor polynomial 
is given by:
$$T_n(x) = \sum_{i = 0}^\infty \frac{x^i}{i!}$$
As expected, as the degree of the polynomial increases, the closer it is to 
$e^x$ (see figure \ref{taylorexp}).

\begin{figure}[htbp]
\centering
    \begin{tikzpicture}
	\begin{axis}[xmin = -2, xmax = 2, axis lines = center, ymin = -2, ymax = 10, 
	legend pos = north west]
        \addplot[black, thick, domain = -2:2]{e^x};
        \addlegendentry{$f(x) = e^x$};
        \addplot[red, thick, domain = -2:2]{1 + x};
        \addlegendentry{$T_1(x)$};
        \addplot[orange, thick, domain = -2:2]{1 + x + x^2/2};
        \addlegendentry{$T_2(x)$};
        \addplot[yellow, thick, domain = -2:2]{1 + x + x^2/2 + x^3/6};
        \addlegendentry{$T_3(x)$};
        \addplot[green, thick, domain = -2:2]{1 + x + x^2/2 + x^3/6 + x^4/24};
        \addlegendentry{$T_4(x)$};
        \addplot[blue, thick, domain = -2:2]{1 + x + x^2/2 + x^3/6 + x^4/24 + 
        x^5/120};
        \addlegendentry{$T_5(x)$};
        \end{axis}
    \end{tikzpicture}
    \caption{As $n$ increases, $T_n(x)$ approaches $f(x)$}
    \label{taylorexp}
\end{figure}

Be sure to write this Taylor series down: you will see it on the AP Calculus 
exam and in your college mathematics classes!

\section{Maclaurin series of trigonometric functions}
Let us write a Maclaurin series for $\sin{x}$. We begin by determining $c_n$ 
for the first few $n$:
\begin{center}
	\begin{tabular}{|c|c|c|}\hline
	$n$ & $f^{(n)}(0)$ & $c_n$\\\hline
	0 & $\sin{(0)} = 0$ & $0/0!$\\\hline
	1 & $\cos{(0)} = 1$ & $1/1!$\\\hline
	2 & $-\sin{(0)} = 0$ & $0/2!$\\\hline
	3 & $-\cos{(0)} = -1$ & $-1/3!$\\\hline
	4 & $\sin{(0)} = 0$ & $0/4!$\\\hline
	\end{tabular}
\end{center}
As you can see, $f^{(n)}(0)$ will cycle between $0$, $1$, and $-1$ as $n$ 
continues to increase. Using this, we can begin to write the first few terms 
of a Maclaurin series for $f(x) = \sin{x}$:
$$\sum_{n=0}^\infty \frac{f^{(n)}(0)}{n!}x^n = \frac{f(0)}{0!}x^0 + \frac{f'(0)
}{1!}x^1 + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + \frac{f^{(IV)}(0)}{4!
}x^4 + \cdots + \frac{f^{(n)}(0)}{n!}x^n$$
$$= \frac{0}{0!} + \frac{1}{1!}x + \frac{0}{2!}x^2 + \frac{-1}{3!}x^3 + \frac{0
}{4!}x^4 + \frac{1}{5!}x^5 + \cdots$$
$$=x + \frac{-1}{3!}x^3 + \frac{1}{5!}x^5 + \frac{-1}{7!}x^7 + \cdots + \frac{(
-1)^n}{(2n + 1)!}x^{2n+1}$$

Therefore, $\sin{x} = \sum_{n=0}^\infty \frac{(-1)^n}{(2n + 1)!}x^{2n + 1}$. 
This is also a series you will see again and again. 

\begin{Exercise}[label=trigmac]
Derive a Maclaurin series for $\cos{x}$. Use it and the Maclaurin series for 
$\sin{x}$ to find a $3^{rd}$ order Maclaurin series for $\tan{x}$. Confirm 
your series for $\tan{x}$ by plotting. 
\end{Exercise}

\begin{Answer}[ref = trigmac]
Part I: Derive a Maclaurin series for $\cos{x}$. There are two methods you 
might have used: You could have used the same method as we used for $\sin{x}$ 
above, or you could have applied the fact that $\frac{d}{dx} \sum_{n=0}^\infty 
c_n x^n = \sum_{n=0}^\infty n c_n x^{n - 1}$. We will show the second method:
$$\cos{x} = \frac{d}{dx} \sin{x}$$
$$\cos{x} = \frac{d}{dx} \sum_{n=0}^\infty \frac{(-1)^n}{(2n + 1)!}x^{2n + 1}$$
$$\cos{x} = \sum_{n=0}^\infty \frac{(-1)^n}{(2n + 1)(2n)!} \left(2n + 1 
\right) x^{2n}$$ 
$$\cos{x} = \sum_{n=0}^\infty \frac{(-1)^n}{(2n)!}x^{2n}$$

This is also an important Maclaurin series you will see again. 
PartII: Find a $3^{rd}$ order Maclaurin series for $\tan{x}$ using the series 
for $\cos{x}$ and $\sin{x}$. We may be tempted to use the same process of 
explicitly calculating the derivatives of $\tan{x}$ at $x = 0$. However, the 
derivative of $\tan{x}$ is $\sec^2{x}$, and the derivatives only get more 
complicated from there. We won't have a nice, cyclical result, like we did 
with $\sin{x}$. Instead, we will use trigonometric identities to help us. 
Recall that $\tan{x} = \frac{\sin{x}}{\cos{x}}$. Therefore, we can say that:
$$\tan{x} = \frac{\sum_{n=0}^\infty \frac{(-1)^n x^{2n + 1}}{(2n + 1)!}}{\sum_{
n = 0}^\infty \frac{(-1)^n x^{2n}}{(2n)!}}$$
We may be tempted to divide the terms directly and have lots of beautiful 
cancellations. However, this would be incorrect (because $\frac{a + b + c + 
\cdots}{A + B + C + \cdots} \neq \frac{a}{A} + \frac{b}{B} + \frac{c}{C} + 
\cdots$). Instead, we will find the first 4 terms (we are starting at $n = 0$, 
so we need 4 terms to reach $n = 3$) and perform long division. 
$$\tan{x} = \frac{x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!}}{1 - 
\frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!}}$$
When we evaluate this, we find the first four terms of the result are $\tan{x} 
\approx x + \frac{x^3}{3} + \frac{2x^5}{15} + \frac{17x^7}{315}$. A plot is 
shown below:

\centering
    \begin{tikzpicture}
	\begin{axis}[xmin = -2, xmax = 2, axis lines = center, ymin = -10, ymax = 10, 
	legend pos = north west, xlabel = $x$, ylabel = $y$]
        \addplot[black, thick, domain = -1.47:1.47, samples = 100]{tan(deg(x))};
        \addlegendentry{$\tan{x}$};
        \addplot[blue, mark = *, only marks, domain = -2:2, samples = 20]{x + 
        x^3/3 + 2*x^5/15 + 17*x^7/315};
        \addlegendentry{$x + \frac{x^3}{3} + \frac{2x^5}{15} + \frac{17x^7}{
        315}$};
        \end{axis}
    \end{tikzpicture}
As you can see, the series is an excellent estimate near $x = 0$. 
\end{Answer}

Another important trigonometric Maclaurin series is
$$\arctan{x} = \sum_{n=0}^\infty \frac{(-1)^n x^{2n + 1}}{2n + 1} = x - \frac{x^3}{3} + \frac{x^5}{5} - \frac{x^7}{7} + \cdots$$
which converges for $|x|<1$. 

\section{Other common Maclaurin series}
We've already seen that:
$$\frac{1}{1 - x} = \sum_{n=0}^\infty x^n$$
which converges for $|x| < 1$. And also:
$$e^x = \sum_{n=0}^\infty \frac{x^n}{n!}$$
Which converges for all real $x$.

In the previous chapter, we also derived a Maclaurin series for $f(x) = \ln{(1 
+ x)}$:
$$\sum_{n=1}^\infty (-1)^{n-1} \frac{x^n}{n}$$
Which converges for $|x|<1$.

\textbf{Example}: Find a Maclaurin series for $f(x) = (1 + x)^k$, where $k$ is 
any real number, and determine its radius of convergence. 

\textbf{Solution}: We begin by finding the first few derivatives and 
evaluating at $x = 0$:
\begin{center}
	\begin{tabular}{|c|c|c|}\\\hline
	$n$ & $f^{(n)}(x)$ & $f^{(n)}(0)$\\\hline
	0 & $(1 + x)^k$ & $1$\\\hline
	1 & $k(1 + x)^{k - 1}$ & $k$\\\hline
	2 & $k(k-1)(1 + x)^{k - 2}$ & $k(k-1)$\\\hline
	3 & $k(k-1)(k-2)(1 + x)^{k-3}$ & $k(k-1)(k-2)$\\\hline
	$\cdots$ & $\cdots$ & $\cdots$\\\hline
	$n$ & $k(k-1)(k-1)\cdots(k-n+1)(1+x)^{k-n}$ & $k(k-1)(k-2)\cdots(k - n + 1)$\\
	\hline
	\end{tabular}
\end{center}

Therefore, $c_n = \frac{k(k-1)\cdots(k - n + 1)}{n!}$ and we can write the 
Maclaurin series:
$$(1 + x)^k = \sum_{n=0}^\infty \frac{k(k-1)(k-2)\cdots(k - n + 1)}{n!}x^n$$

This is called the \textbf{binomial series}\index{binomial series}. Another 
notation you can use is:
$$\left( _n^k \right) = \frac{k(k-1)(k-2)\cdots(k-n+1)}{n!}$$

To determine the radius of convergence, we apply the ratio test:
$$\lim_{n \to \infty} \left| \frac{a_{n + 1}}{a_n} \right| < 1$$
$$\lim_{n \to \infty} \left| \frac{k(k-1)(k-2)\cdots(k - n + 1)(k -n)x^{n + 1}}
{(n + 1)n!} \cdot \frac{n!}{k(k-1)(k-2)\cdots(k-n+1)x^n} \right| < 1$$
$$\lim_{n \to \infty} \left| \frac{(k-n)x}{n + 1} \right| = \lim_{n \to \infty} 
\frac{|k - n||x|}{n + 1} < 1$$
$$\lim_{n \to \infty} \frac{\left| 1 - \frac{k}{n} \right|}{1 + \frac{1}{n}}|x| 
= |x| < 1$$
Therefore, the series converges for $|x|<1$ and the radius of convergence is 1. 

\textbf{Example}: Find the sum of the series $\frac{1}{1 \cdot 2} - \frac{1}{2 
\cdot 2^2} + \frac{1}{3 \cdot 2^3} - \frac{1}{4 \cdot 2^4} + \cdots$. 

\textbf{Solution}:We can write this series in sigma notation:
$$\sum_{n=1}^\infty (-1)^{n-1} \frac{1}{n \cdot 2^n} = \sum_{n = 1}^\infty 
\frac{1}{n} \cdot \left( \frac{1}{2} \right)^n$$
Notice this is the same as the series for $\ln{1 + x}$ when $x = \frac{1}{2}$. 
Therefore, 
$$\sum_{n = 1}^\infty \frac{1}{n} \cdot \left( \frac{1}{2} \right)^n = \ln{1 + 
\frac{1}{2}} = \ln{\frac{3}{2}}$$

\begin{Exercise}[label = mac1]
[The problem was originally presented as a no-calculator, multiple-choice 
question on the 2012 AP Calculus BC exam.] The Maclaurin series for the 
function $f$ is given by $f(x) = \sum_{n=0}^\infty \left( -\frac{x}{4} \right)^
n$. What is the value of $f(3)$?
\end{Exercise}

\begin{Answer}[ref = mac1]
Substituting $x = 3$, the series is $\sum_{n=0}^\infty \left( -\frac{3}{4} 
\right)^n$, which is an alternating geometric series. Reindexing the series to 
begin at $n = 1$, this is equivalent to $\sum_{n = 1}^\infty \left( - 
\frac{3}{4} \right) ^ {n - 1}$, which is in the standard form $\sum_{n=1}^
\infty ar^{n-1}$ with $a = 1$ and $r = -\frac{3}{4}$. Then the value of the 
series is $\frac{a}{1-r} = \frac{1}{1-\left(- \frac{3}{4} \right)} = \frac{1}{1 
+ \frac{3}{4}} = \frac{1}{\frac{7}{4}} = \frac{4}{7}$. 
\end{Answer}

\begin{Exercise}[label = taylor1]
[This problem was originally presented as a calculator-allowed, multiple-choice 
question on the 2012 AP Calculus BC exam.] Let $f$ be function having 
derivatives of all orders for $x > 0$ such that $f(3) = 2$, $f'(3) = -1$, 
$f''(3) = 6$, and $f'''(3) = 12$. Write a $3^{rd}$-degree Taylor polynomial 
for $f$ about $x = 3$ and estimate the value of $f(3.4)$
\end{Exercise}

\begin{Answer}[ref = taylor1]
A third-degree Taylor polynomial about $x = 3$ is given by $f(3) + \frac{
f'(3)}{1!} (x - 3) + \frac{f''(3)}{2!} (x - 3) ^ 2 + \frac{f'''(3)}{3!} (x - 3) 
^ 3$. Substituting what we know, they 3rd-degree Taylor polynomial is $f(x) 
\approx 2 + \frac{-1}{1} (x - 3) + \frac{6}{2} (x - 3) ^ 2 + \frac{12}{6}(x - 
3) ^ 3 = 2 - (x - 3) + 3 (x - 3) ^ 2 + 2 (x - 3) ^ 3$. Substituting $x = 3.5$, 
we find that $f(3.5) \approx 2 - (3.5 - 3) + 3 ( 3.5 - 3) ^ 2 + 2 (3.5 - 3) ^ 3 
= 2 - \frac{1}{2} + 3 \frac{1}{4} + 2\frac{1}{8} = 2 - \frac{1}{2} + 
\frac{3}{4} + \frac{1}{4} = 2.5$.
\end{Answer}

\begin{Exercise}[label = taylor2]
[This problem was originally presented as a calculator-allowed, free-response 
question on the 2012 AP Calculus BC exam.] The function $f$ is twice 
differentiable for $x > 0$ with $f(1) = 15$, $f'(1) = 8$, and $f''(1) = 20$. 
Write the second-degree Taylor polynomial about $x = 1$ and use it to 
estimate $f(1.4)$.
\end{Exercise}

\begin{Answer}
A second-degree Taylor polynomial about $x = 1$ is given by $f(x) \approx f(1) 
+ \frac{f'(1)}{1!}(x - 1) + \frac{f''(1)}{2!}(x - 1)^2 = 15 + 8(x - 1) + 10(x 
- 1)^2$. Substituting $x = 1.4$, we find that $f(1.4) \approx 15 + 8(1.4 - 1) 
+ 10(1.4 - 1)^2 = 19.8$.
\end{Answer}

\begin{Exercise}[label = mac2]
[The problem was originally presented as a no-calculator, multiple-choice 
question on the 2012 AP Calculus BC exam.] For $x > 0$, the power series $1 - 
\frac{x^2}{3!} + \frac{x^4}{5!} - \frac{x^6}{7!} + \cdots + (-1)^n \frac{2^{2n
}}{(2n + 1)!}$ converges to which of the following?
(a) $\cos{x}$
(b) $\sin{x}$
(c) $\frac{\sin{x}}{x}$
(d) $e^x - e^{x^2}$
(e) $1 + e^x - e^{x^2}$
\end{Exercise}

\begin{Answer}
(C). Since $\sin{x} = \sum_{n=0}^\infty (-1)^n \frac{x^{2n + 1}}{(2n + 1)!}$, 
then $\frac{\sin{x}}{x}} = \sum_{n = 0}^\infty (-1)^n \frac{x^{2n + 1}}{x(2n+1
)!} = \sum_{n=0}^\infty (-1)^n \frac{2^{2n}}{(2n + 1)!}$.
\end{Answer}


